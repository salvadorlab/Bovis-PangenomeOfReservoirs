2
setwd("/Users/noah_/Documents/Bovis-PangenomeOfReservoirs/Resources/")
assembly_stats <- read.table("transposed_report.tsv",header = TRUE)
assembly_stats <- read.table("transposed_report.tsv",header = TRUE, sep = "\t")
assembly_stats <- read.csv("transposed_report.tsv",header = TRUE)
View(assembly_stats)
assembly_stats <- read.csv("mbovis_transposed_report.csv",header = TRUE)
View(assembly_stats)
hist(assembly_stats$N50)
hist(assembly_stats$X..contigs)
library(ggplot2)
assembly_stats %>% ggplot(aes(x=N50)) + geom_histogram(binwidth = 15)
library(dplyr)
ggbarplot(accession_bar,"Species","no_in_data", fill = "Host", color = "Host",palette = c("steelblue","red"), xlab = "Host Species", ylab = "No. of isolates", lab.size = 10) + theme(axis.text.x = element_text(angle = 45, hjust = 1),axis.text=element_text(size = 15), axis.title = element_text(size = 18)) + scale_y_log10()
assembly_stats %>% ggplot(aes(x=N50)) + geom_histogram(binwidth = 15)
assembly_stats %>% ggplot(aes(x=N50)) + geom_histogram(binwidth = 100)
assembly_stats %>% ggplot(aes(x=N50)) + geom_histogram(binwidth = 1000)
hist(assembly_stats$N50)
assembly_stats %>% ggplot(aes(x=N50)) + geom_histogram(binwidth = 10000)
assembly_stats %>% ggplot(aes(x=N50)) + geom_histogram(binwidth = 5000)
assembly_stats %>% ggplot(aes(x=N50))
+ geom_histogram(binwidth = 5000)
assembly_stats %>% ggplot(aes(x=N50)) +
geom_histogram(binwidth = 5000)
assembly_stats %>% ggplot(aes(x=N50)) +
geom_histogram(binwidth = 5000) +
theme_ipsum()
assembly_stats %>% ggplot(aes(x=N50)) +
geom_histogram(binwidth = 5000) +
theme_classic()
assembly_stats %>% ggplot(aes(x=N50)) +
geom_histogram(binwidth = 5000) +
theme_linedraw()
assembly_stats %>% ggplot(aes(x=N50)) +
geom_histogram(binwidth = 5000) +
theme_light()
assembly_stats %>% ggplot(aes(x=N50)) +
geom_histogram(binwidth = 5000, fill = "steelblue", color = "steelblue") +
theme_light()
assembly_stats %>% ggplot(aes(x=Total.length)) +
geom_histogram(binwidth = 50000, fill = "steelblue", color = "steelblue") +
theme_light()
assembly_stats %>% filter(Total.length < 5000000) %>% ggplot(aes(x=Total.length)) +
geom_histogram(binwidth = 50000, fill = "steelblue", color = "steelblue") +
theme_light()
assembly_stats %>% filter(Total.length < 5000000) %>% ggplot(aes(x=Total.length)) +
geom_histogram(binwidth = 5000, fill = "steelblue", color = "steelblue") +
theme_light()
install.packages("patchwork")
install.packages("patchwork")
library(patchwork)
N50_hist | genome_length_hist
N50_hist <- assembly_stats %>% ggplot(aes(x=N50)) +
geom_histogram(binwidth = 5000, fill = "steelblue", color = "steelblue") +
theme_light()
genome_length_hist <- assembly_stats %>% filter(Total.length < 5000000) %>% ggplot(aes(x=Total.length)) +
geom_histogram(binwidth = 5000, fill = "steelblue", color = "steelblue") +
theme_light()
N50_hist | genome_length_hist
summarise(assembly_stats$GC....)
summarise()
summary(assembly_stats$GC....)
assembly_stats %>% ggplot(aes(x=GC....)) +
geom_histogram(binwidth = 0.25, fill = "steelblue", color = "steelblue") +
theme_light()
assembly_stats %>% filter(GC... > 62) %>% ggplot(aes(x=GC....)) +
geom_histogram(binwidth = 0.25, fill = "steelblue", color = "steelblue") +
theme_light()
assembly_stats %>% filter(GC.... > 62) %>% ggplot(aes(x=GC....)) +
geom_histogram(binwidth = 0.25, fill = "steelblue", color = "steelblue") +
theme_light()
assembly_stats %>% filter(GC.... > 65.49) %>% filter(GC.... < 65.61) %>% ggplot(aes(x=GC....)) +
geom_histogram(binwidth = 0.05, fill = "steelblue", color = "steelblue") +
theme_light()
assembly_stats %>% filter(GC.... > 65.49) %>% filter(GC.... < 65.61) %>% ggplot(aes(x=GC....)) +
geom_histogram(binwidth = 0.005, fill = "steelblue", color = "steelblue") +
theme_light()
GC_hist <- assembly_stats %>% filter(GC.... > 65.49) %>% filter(GC.... < 65.61) %>% ggplot(aes(x=GC....)) +
geom_histogram(binwidth = 0.005, fill = "steelblue", color = "steelblue") +
theme_light()
summary(assembly_stats$Genome.fraction....)
summary(assembly_stats$Duplication.ratio)
assembly_stats %>% filter(Genome.fraction.... > 98.38) %>% filter(Genome.fraction.... < 98.92) %>% ggplot(aes(x=Genome.fraction....)) +
geom_histogram(binwidth = 0.005, fill = "steelblue", color = "steelblue") +
theme_light()
assembly_stats %>% filter(Genome.fraction.... > 98.38) %>% filter(Genome.fraction.... < 98.92) %>% ggplot(aes(x=Genome.fraction....)) +
geom_histogram(binwidth = 0.01, fill = "steelblue", color = "steelblue") +
theme_light()
GC_hist <- assembly_stats %>% filter(GC.... > 65.49) %>% filter(GC.... < 65.61) %>% ggplot(aes(x=GC....)) +
geom_histogram(binwidth = 0.005, fill = "steelblue", color = "steelblue") +
theme_light()
genome_frac_hist <- assembly_stats %>% filter(Genome.fraction.... > 98.38) %>% filter(Genome.fraction.... < 98.92) %>% ggplot(aes(x=Genome.fraction....)) +
geom_histogram(binwidth = 0.01, fill = "steelblue", color = "steelblue") +
theme_light()
(N50_hist | genome_length_hist)/(GC_hist | genome_frac_hist)
quantile(assembly_stats$N50,5)
quantile(assembly_stats$N50,0.05)
quantile(assembly_stats$Genome.fraction....,0.05)
summary(assembly_stats$GC....)
65.61 - 65.49
iqr <- 65.61 - 65.49
1.5*iqr
summary(assembly_stats$Total.length)
4311607 - 4291430
1.5*20177
4291430 - 30265.5
4311607 + 30265.5
assembly_stats %>% filter(N50 > 46069.75) %>% ggplot(aes(x=N50)) +
geom_histogram(binwidth = 5000, fill = "steelblue", color = "steelblue") +
theme_light()
assembly_stats %>% filter(Total.length < 4341873 ) %>% filter(Total.length > 4261165 ) %>% ggplot(aes(x=Total.length)) +
geom_histogram(binwidth = 5000, fill = "steelblue", color = "steelblue") +
theme_light()
assembly_stats %>% filter(Total.length < 4341873 ) %>% filter(Total.length > 4261165 ) %>% ggplot(aes(x=Total.length)) +
geom_histogram(binwidth = 1000, fill = "steelblue", color = "steelblue") +
theme_light()
assembly_stats %>% filter(GC.... > 65.31) %>% filter(GC.... < 65.79) %>% ggplot(aes(x=GC....)) +
geom_histogram(binwidth = 0.005, fill = "steelblue", color = "steelblue") +
theme_light()
assembly_stats %>% filter(Genome.fraction.... > 97.84405) %>% filter(Genome.fraction.... < 98.92) %>% ggplot(aes(x=Genome.fraction....)) +
geom_histogram(binwidth = 0.01, fill = "steelblue", color = "steelblue") +
theme_light()
assembly_stats %>% filter(Genome.fraction.... > 97.84405) %>% ggplot(aes(x=Genome.fraction....)) +
geom_histogram(binwidth = 0.01, fill = "steelblue", color = "steelblue") +
theme_light()
N50_hist <- assembly_stats %>% filter(N50 > 46069.75) %>% ggplot(aes(x=N50)) +
geom_histogram(binwidth = 5000, fill = "steelblue", color = "steelblue") +
theme_light()
genome_length_hist <- assembly_stats %>% filter(Total.length < 4341873 ) %>% filter(Total.length > 4261165 ) %>% ggplot(aes(x=Total.length)) +
geom_histogram(binwidth = 1000, fill = "steelblue", color = "steelblue") +
theme_light()
GC_hist <- assembly_stats %>% filter(GC.... > 65.31) %>% filter(GC.... < 65.79) %>% ggplot(aes(x=GC....)) +
geom_histogram(binwidth = 0.005, fill = "steelblue", color = "steelblue") +
theme_light()
genome_frac_hist <- assembly_stats %>% filter(Genome.fraction.... > 97.84405) %>% ggplot(aes(x=Genome.fraction....)) +
geom_histogram(binwidth = 0.01, fill = "steelblue", color = "steelblue") +
theme_light()
(N50_hist | genome_length_hist)/(GC_hist | genome_frac_hist)
filtered_assembly_stats <- assembly_stats %>% filter(Genome.fraction.... > 97.84405) %>% filter(GC.... > 65.31) %>% filter(GC.... < 65.79) %>% filter(Total.length < 4341873 ) %>% filter(Total.length > 4261165 ) %>% filter(N50 > 46069.75)
names <- gsub('.scaffold','',filtered_assembly_stats$ï..Assembly)
names[1]
accession_meta <- read.csv("ProjectBovisReservoir_metadata.csv", header = TRUE, stringsAsFactors = FALSE)
filtered_accession_metadata <- accession_meta[accession_meta$ï..Sample %in% names,]
View(filtered_accession_metadata)
library("ggpubr")
accession_bar <- filtered_accession_metadata %>% group_by(Species, Host) %>%summarise(no_in_data = length(Species))
accession_bar <- accession_bar[order(accession_bar$Host,accession_bar$no_in_data),]
#A bar plot separated by species, colored by reservoir status.
ggbarplot(accession_bar,"Species","no_in_data", fill = "Host", color = "Host",palette = c("steelblue","red"), xlab = "Host Species", ylab = "No. of isolates", lab.size = 10) + theme(axis.text.x = element_text(angle = 45, hjust = 1),axis.text=element_text(size = 15), axis.title = element_text(size = 18)) + scale_y_log10()
